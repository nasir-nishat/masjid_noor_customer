import 'package:masjid_noor_customer/presentation/pages/all_export.dart';import 'package:masjid_noor_customer/presentation/pages/cart/cart_controller.dart';import 'package:masjid_noor_customer/presentation/pages/product/product_controller.dart';import 'package:mobile_scanner/mobile_scanner.dart';class BarcodeScannerSimple extends StatefulWidget {  const BarcodeScannerSimple({super.key});  @override  State<BarcodeScannerSimple> createState() => _BarcodeScannerSimpleState();}class _BarcodeScannerSimpleState extends State<BarcodeScannerSimple> {  Barcode? _barcode;  bool _isScanDone = false;  @override  void initState() {    super.initState();    _isScanDone = false;  }  @override  Widget build(BuildContext context) {    return Scaffold(      appBar: AppBar(title: const Text('Scan the Product')),      body: Stack(        children: [          MobileScanner(            onDetect: _handleBarcode,            fit: BoxFit.cover,          ),        ],      ),    );  }  void _handleBarcode(BarcodeCapture barcodes) async {    if (!mounted) return;    if (_isScanDone) return;    setState(() {      _barcode = barcodes.barcodes.firstOrNull;      _isScanDone = true;    });    if (_barcode != null) {      ProductMd? product = await ProductController.to          .searchProductByBarcode(_barcode!.displayValue!);      if (product != null) {        CartController.to.addToCart(product);        showToast('Product added to cart!');      } else {        showToast('There is no Product found\nwith this barcode!',            isWarning: true);      }    }    if (mounted) context.pop();  }}